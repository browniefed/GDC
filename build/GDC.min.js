!function(a){var b=function(){var a;try{Object.create(null),a=Object.create}catch(b){a=function(){var a=function(){};return function(b,c){var d;return null===b?{}:(a.prototype=b,d=new a,c&&Object.defineProperties(d,c),d)}}()}return a}(),c=function(){try{return Object.defineProperty({},"test",{value:0}),Object.defineProperty}catch(a){return function(a,b,c){a[b]=c.value}}}(),d=function(a){try{try{Object.defineProperties({},{test:{value:0}})}catch(b){throw b}return Object.defineProperties}catch(b){return function(b,c){var d;for(d in c)c.hasOwnProperty(d)&&a(b,d,c[d])}}}(c),e=void 0,f=function(){return function(a,b){var c,d,e=this;if("object"==typeof a){c=[];for(d in a)a.hasOwnProperty(d)&&(c[c.length]=this.on(d,a[d]));return{cancel:function(){for(;c.length;)c.pop().cancel()}}}return this._subs[a]?this._subs[a].push(b):this._subs[a]=[b],{cancel:function(){e.off(a,b)}}}}(),g=function(){return function(a,b){var c,d;b||(a?this._subs[a]=[]:this._subs={}),c=this._subs[a],c&&(d=c.indexOf(b),-1!==d&&c.splice(d,1))}}(),h=function(){return function(a){var b,c,d,e=this._subs[a];if(e)for(b=Array.prototype.slice.call(arguments,1),c=0,d=e.length;d>c;c+=1)e[c].apply(this,b)}}(),i=function(a,b,c,d){return{hasFocus:a,on:b,off:c,fire:d}}(e,f,g,h),j=function(){return{fromRange:function(a,b){return{from:_.clone(a),to:_.clone(b)}},toRange:function(a,b){return{from:_.clone(b),to:_.clone(a)}}}}(),k=function(a){var b={},c=!1,d=[],e={},f={};return{addStyle:function(a,c){b[a]=c},removeStyle:function(a){b[a]=null},removeStyleFromSelection:function(b,g,h){return d=b.doc.findMarksAt(g.from)||[],c=!1,d.concat(b.doc.findMarksAt(g.to)||[]),d.length&&_(d).forEach(function(d){d.className==h&&(e=a.fromRange(d.find().from,g.from),f=a.toRange(d.find().to,g.to),d.clear(),b.doc.markText(e.from,e.to,{className:"gdc-style-"+h}),b.doc.markText(f.from,f.to,{className:"gdc-style-"+h}),c=!0)}),c}}}(j),l=function(a){var b,c={},d=!1;return c.name="bold",c.executeStyle=function(e){b=this._codemirror.getCodemirror(),e&&(d=a.removeStyleFromSelection(b,e,"gdc-style-"+c.name),d||this._codemirror.getCodemirror().doc.markText(e.from,e.to,{className:"gdc-style-"+c.name}))},c}(k),m=function(a){var b,c={},d=!1;return c.name="italic",c.executeStyle=function(e){b=this._codemirror.getCodemirror(),e&&(d=a.removeStyleFromSelection(b,e,"gdc-style-"+c.name),d||this._codemirror.getCodemirror().doc.markText(e.from,e.to,{className:"gdc-style-"+c.name}))},c}(k),n=function(a){var b,c={},d=!1;return c.name="underline",c.executeStyle=function(e){b=this._codemirror.getCodemirror(),e&&(d=a.removeStyleFromSelection(b,e,"gdc-style-"+c.name),d||this._codemirror.getCodemirror().doc.markText(e.from,e.to,{className:"gdc-style-"+c.name}))},c}(k),o=function(a){var b,c={},d=!1;return c.name="strikethrough",c.executeStyle=function(e){b=this._codemirror.getCodemirror(),e&&(d=a.removeStyleFromSelection(b,e,"gdc-style-"+c.name),d||this._codemirror.getCodemirror().doc.markText(e.from,e.to,{className:"gdc-style-"+c.name}))},c}(k),p=function(a){var b,c={},d=!1;return c.name="ul",c.executeStyle=function(e){b=this._codemirror.getCodemirror(),e&&(d=a.removeStyleFromSelection(b,e,"gdc-style-"+c.name),d||this._codemirror.getCodemirror().doc.markText(e.from,e.to,{className:"gdc-style-"+c.name}))},c}(k),q=function(a){var b,c={},d=!1;return c.name="ol",c.executeStyle=function(e){b=this._codemirror.getCodemirror(),e&&(d=a.removeStyleFromSelection(b,e,"gdc-style-"+c.name),d||this._codemirror.getCodemirror().doc.markText(e.from,e.to,{className:"gdc-style-"+c.name}))},c}(k),r=function(a,b,c,d,e,f,g){var h={bold:b,italic:c,underline:d,strikethrough:e,ol:f,ul:g},i={},j=!1,k={};return i.applyStyle=function(b){return(j=this._codemirror.getCodemirror().somethingSelected())?(k.from=this._codemirror.getCodemirror().doc.getCursor(!0),k.to=this._codemirror.getCodemirror().doc.getCursor(!1),h[b].executeStyle.call(this,k),void 0):(a.addStyle(b,h[b]),void 0)},i}(k,l,m,n,o,p,q),s=function(){return[]}(),t=function(){var a=function(a){this.codemirror=a};return a.prototype.getCodemirror=function(){return this._codemirror},a.prototype.getSelection=function(){},a.prototype.fromTextArea=function(a){this._codemirror=this.codemirror.fromTextArea(a)},a}(),u=function(){var a={};return a.name="comment",a.insertWidget=function(a){},a}(),v=function(){return{tableCreate:function(a,b){var c=document.createElement("table");c.style.width="100%",c.style.height="100px",c.style.border="1px solid #000",a=a||2,b=b||3;for(var d=0;b>d;d++)for(var e=c.insertRow(),f=0;a>f;f++){var g=e.insertCell();g.style.border="1px solid #000",g.appendChild(document.createTextNode(" "))}return c}}}(),w=function(a){function b(b,c){this.DOMEle=a.tableCreate(b,c),this.tableCells=[]}return b.prototype.getDOM=function(){return this.DOMEle},b.prototype.setWidget=function(a){this.widget=a},b.prototype.initTableCells=function(a){var b=this.widget.node.querySelectorAll("td"),c=[];_(b).forEach(function(b){c.push(new a(b))}),this.tableCells=c},b.prototype.destroy=function(){this.widget.clear()},b.prototype.addStyle=function(a){_(this.tableCells).each(function(b){b.fire(a)})},b}(v),x=function(a){var b,c,d={};return d.name="image",d.insertWidget=function(){b=this._codemirror.getCodemirror(),c=this._codemirror.codemirror;var d=b.doc.getCursor(!0),e=b.doc.getCursor(!1),f=new a("morgan.png");b.markText(d,e,{replacedWith:f.getDOM()})},d}(w),y=function(){var a={};return a.name="link",a.insertWidget=function(a){},a}(),z=function(a){var b,c,d={};return d.name="table",d.insertWidget=function(){b=this._codemirror.getCodemirror(),c=this._codemirror.codemirror;var d=b.doc.getCursor(!0).line,e=new a(2,5);return e.setWidget(b.addLineWidget(d,e.getDOM())),e.initTableCells(c),e},d}(w),A=function(a,b,c,d){var e={comment:a,image:b,link:c,table:d},f=[];return{insert:function(a){f.push(e[a].insertWidget.call(this))},getCreatedWidgets:function(){return f}}}(u,x,y,z),B=function(a,b,c,d){return function(e,f){b(e,{_subs:{value:{}}}),e._codemirror=new a(f.codemirror,{lineWrapping:!0}),e._codemirror.fromTextArea(f.el),e.on("bold",function(){c.applyStyle.call(e,"bold",{})}),e.on("italic",function(){c.applyStyle.call(e,"italic",{})}),e.on("strikethrough",function(){c.applyStyle.call(e,"strikethrough",{})}),e.on("underline",function(){c.applyStyle.call(e,"underline",{})}),e.on("insert-table",function(){d.insert.call(e,"table")}),e.on("insert-image",function(){d.insert.call(e,"image")}),e.on("ol",function(){c.applyStyle.call(e,"ol",{})}),e.on("ul",function(){c.applyStyle.call(e,"ul",{})})}}(t,d,r,A),C=function(a,b,c,d,e,f){var g=function(a,b){f(this,{codemirror:a,el:b})};return b(g,{prototype:{value:c},_subs:{value:{}}}),g.prototype.constructor=g,e.GDC=g,g}(b,d,i,r,s,B),D=function(a,b){for(;b.length;)b.pop()();return a}(C,s);"undefined"!=typeof module&&module.exports?module.exports=D:"function"==typeof define&&define.amd?define(function(){return D}):(console.log("global"),a.GDC=D)}("undefined"!=typeof window?window:this);